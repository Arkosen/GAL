#!/usr/bin/perl
use strict;
use warnings;
use Getopt::Long;
use GAL::Annotation;

#-----------------------------------------------------------------------------
#----------------------------------- MAIN ------------------------------------
#-----------------------------------------------------------------------------

my $usage = "

Synopsis:

load_gal_db --driver --db  file

Description:

Load a gal_database

Options:

  --driver    (mysql SQLite)
  --user      Database user name
  --password  Database password
  --db_name   Database name

";


my ($help, $driver, $user, $password, $db_name);
my $opt_success = GetOptions('help'       => \$help,
			     'driver=s'   => \$driver,
			     'user=s'     => \$user,
			     'password=s' => \$password,
			     'db_name=s'  => \$db_name,
			      );

die $usage if $help || ! $opt_success;

my @files = @ARGV;
die $usage if grep {! -r $_} @files;

my $store_args = {class    => $driver,
		  database => $db_name,
		  user     => $user,
		  password => $password,
		 };

my $feat_store = GAL::Annotation->new(storage => $store_args);

$feat_store->parser(class => 'gff3_fast');

$feat_store->load_files(files => \@files,
			mode  => 'overwrite',
		       );
