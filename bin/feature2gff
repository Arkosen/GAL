#!/usr/bin/perl
use strict;
use warnings;
use Getopt::Long;

use lib '../lib/';

#-----------------------------------------------------------------------------
#----------------------------------- MAIN ------------------------------------
#-----------------------------------------------------------------------------
my $usage = "

Synopsis:

feature2gff3 --format celera feature_file

Description:

Convert various sequence feature formats to GFF3.


Options:

  --format   The format fo the feature file (a subclass of Parser e.g.
             gigabayes, maq, clcbio, soap, celera);

";


my ($help, $format);
my $opt_success = GetOptions('help'         => \$help,
			     'format=s'     => \$format,
			    );

die $usage if $help || ! $opt_success;
die $usage unless grep {$format eq $_} qw(gigabayes maq clcbio soap celera);

my @files = @ARGV;
die $usage unless @files;

for my $file (@files) {

	my $class = "Parser::$format";
	eval "require $class";
	die $@ if $@;

	my $parser = $class->new(file => $file);
	my @features = $parser->get_features;

	for my $feature (@features) {
		print $feature->to_gff3;
		print "\n";
	}
}
