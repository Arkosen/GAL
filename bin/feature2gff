#!/usr/bin/perl
use strict;
use warnings;
use Getopt::Long;

use GAL::Parser;

#-----------------------------------------------------------------------------
#----------------------------------- MAIN ------------------------------------
#-----------------------------------------------------------------------------
my $usage = "

Synopsis:

feature2gff3 --format gigabayes gigabayes_output.gff

Description:

Convert various sequence feature formats to GFF3.

Options:

  --format   The format fo the feature file (a subclass of Parser e.g.
             gigabayes, maq, clcbio, soap, celera);

";


my ($help, $format);
my $opt_success = GetOptions('help'         => \$help,
			     'format=s'     => \$format,
			    );

die $usage if $help || ! $opt_success;

my @files = @ARGV;
die $usage unless @files;

for my $file (@files) {

	my $class = "GAL::Parser::$format";
	eval "require $class";
	die $@ if $@;

	my $parser = $class->new(file => $file);
	#my @features = $parser->get_features;

	#for my $feature (@features) {
	while (my $feature = $parser->parse_next_feature) {
		print $feature->to_gff3;
		print "\n";
	}
}
